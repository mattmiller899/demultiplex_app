BootStrap: docker
From: ubuntu:latest

%environment
    PATH=/app/demultiplex_app/scripts:$PATH

%runscript
    /miniconda/bin/python pipeline.py $@

%post
    apt-get update
    apt-get install -y locales git 
    locale-gen en_US.UTF-8

    #
    # Put everything into $APP_DIR
    #
    mkdir -p /app
    cd /app
    git clone http://github.com/mattmiller899/demultiplex_app.git 

	#
    # Mount points for TACC directories
    # 
    mkdir /home1
    mkdir /scratch
    mkdir /work
    wget https://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh
    chmod u+x Miniconda-latest-Linux-x86_64.sh
    ./Miniconda-latest-Linux-x86_64.sh -b -p /miniconda
    /miniconda/bin/conda install argparse glob gzip itertools logging os re shutil sys scandir operator subprocess traceback
    /miniconda/bin/conda install qiime matplotlib=1.4.3 mock nose -c bioconda
