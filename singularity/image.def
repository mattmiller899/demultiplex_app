BootStrap: docker
From: ubuntu:latest

%environment
    PATH=/app/stampede2-template/scripts:$PATH

%runscript
    exec run_pipeline.sh $@

%post
    apt-get update
    apt-get install -y locales git 
    locale-gen en_US.UTF-8

    #
    # Put everything into $APP_DIR
    #
    mkdir -p /app
    cd /app
    git clone git@github.com:hurwitzlab/stampede2-template.git

    # 
    # Mount points for TACC directories
    # 
    mkdir /home1
    mkdir /scratch
    mkdir /work
    wget https://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh
    chmod u+x Miniconda-latest-Linux-x86_64.sh
    ./Miniconda-latest-Linux-x86_64.sh -b -p /miniconda
    /miniconda/bin/conda install argparse glob gzip itertools logging os re shutil sys scandir operator subprocess traceback

